# 付録

## 開発を始める前に {#before}
本書は駅すぱあとWebサービスの入門書として、流れを追いながら学習できるように書きました。まずは余計なことを考えずに触ってもらいたいという思いもあり、注意点等は最低限に抑えました。
ここで改めて開発時に特に注意すべき点を「付録」という形で用意しました。
また、それ以外の注意点や詳細はオンラインで公開しているドキュメント[^1]に記載してありますのでそちらをご覧ください。

### レスポンスXMLのデータ構造について {#xml}

JSONを使われる方は流して読む程度で構いませんが、XMLを使おうと考えている方は注意して読んで頂ければと思います。
駅すぱあとWebサービスでは後方互換性を保って機能追加が行われていますが、互換性維持のために幾つかのポイントを意識する必要があります。

特に重要なのが、要素の取得についてです。要素は表す内容に対してユニークですが、階層や全体のデータの中でユニークなわけではありません。
例えばStation要素は駅を表しますが、全体のデータ構造に対して、あらたに駅を表現する必要があれば、今までなかった階層や親要素の子要素として出現する可能性があります。つまり、現時点でのデータ構造のみを前提とした相対パスでの実装は大きな危険を伴います。同じStationでも親子関係における文脈の意味が強くでるため、必ず絶対パスで取得するようにしてください。
XMLを利用する際には、XMLパーサを利用することが多いかと思いますが、DOMでパースしてXPATHを利用する際には手軽に相対パスで取得できてしまうため、注意が必要です。

### 課金の対象を知る {#charge}

多くのAPIが用意されていますが、その中にも課金対象となるものとそうでないものがあります。意図せず無駄な課金が発生してしまい、想定していたよりも費用が掛かってしまうのは望むところではありません。
特に良くあるのが、「[アプリケーションを作ってみよう](/docs/app.md)」の項にもある駅の入力補助をインクリメンタルサーチで実装するケースです。実装には駅情報API(/station)を用いるように見えますが、駅情報API(/station)は課金対象です。コール数が多くなるインクリメンタルサーチに利用するのは現実的ではありません。そのために課金対象外のAPIとして駅簡易情報API(/station/light)を用意しています。駅簡易情報API(/station/light)は駅情報API(/station)のサブセットのような扱いになっており、駅の座標等を持っていないので課金対象外となっています。インクリメンタルサーチの結果に必要なのは名称やコードなのでこのような実装には駅簡易情報API(/station/light)で十分です。
駅簡易情報API(/station/light)以外にも経路を検索するまでに必要な操作は基本的に課金対象外として用意してありますので、結果を得る過程で不要な課金を避けることができます。

いかがでしょうか？他にも注意点はありますが、全てドキュメントに記載されていますので開発を始める際にはご一読ください。

## 開発お役立ちツール {#tools}

駅すぱあとWebサービスを使って開発をする上で、実際に著者が活用しているツールをご紹介します。

### APIの仕様理解を深める「API Checker」 {#apichecker}

駅すぱあとWebサービスのドキュメントサイトでは、APIを試すのにぴったりなツール「API Chercker」[^2]を用意しています。これは、APIの仕様を調べるだけではなく、APIをインタラクティブに呼び出し挙動を試すことができるため、APIの理解を深めることができます。

▼図12 ドキュメントサイトで用意しているAPI Checkerの画面

![img](/img/12.png)

### 開発者ツールを使いこなす {#devtool}

今回実装したアプリケーションのように、JavaScriptを使ってWebブラウザ上で動くアプリケーションを作るなら、「開発者ツール」を使いこなしましょう。開発速度がグッとあがるはずです。
開発者ツールとは、ブラウザに搭載されているデバッグツールです。「デベロッパーツール」とも呼ばれることがありますが、本資料では「開発者ツール」と表記します。現在だとほぼ全てのWebブラウザで標準搭載されており、Windowsの場合は「F12」、Macの場合は「Option + Command + i」で起動できます。

▼図13 Webブラウザ上で開発者ツールを立ち上げた状態（Google Chrome）

![img](/img/13.png)

ここからは、Google Chromeを例に説明します。開発者ツールの「Console」パネルは、JavaScriptのデバッグに役立ちます。アプリケーションが意図しない挙動をしている時は、まずConsoleパネルでエラーが発生していないか確認しましょう。図14は、JavaScriptコード内でシンタックスエラーが発生している例です。

▼図14 開発者ツールのConsoleパネル

![img](/img/14.png)

「Network」パネルは、表示しているページで行うHTTP通信が一覧として現れ、リクエスト、レスポンスの内容やアクセスの状況を見ることができます。つまり、駅すぱあとWebサービスへのアクセスに成功しているか、どんなやりとりがされているか確認できます（図15）。

▼図15 開発者ツールのNetworkパネル

![img](/img/15.png)

詳細な使い方に関してもっと知りたくなったかと思いますが、インターネット上にたくさんの情報が公開されているので、ここでは割愛します。
興味を持って探求することはエンジニアとしてのスキルアップに繋がるはずです。ぜひ調べてみてください。

## リンク集 {#link}

##### ・駅すぱあとWebサービス 製品ページ

駅すぱあとWebサービスの情報はこちらにまとまっています。  
https://ekiworld.net/service/sier/webservice/index.html

##### ・駅すぱあとWebサービス 開発者向けドキュメント

APIの仕様や開発に役立つ多くの情報を載せています。  
http://docs.ekispert.com/v1/

##### ・HTML5インターフェースサンプル

HTMLとJavaScript、CSSで実装された画面をサンプルとして提供しているものです。  
https://github.com/EkispertWebService/GUI

##### ・駅すぱあとWebサービス Facebookページ

駅すぱあとWebサービスに関しての最新の情報を配信しています。  
https://www.facebook.com/EkispertWebService/

##### ・ステータスページ

駅すぱあとWebサービスの稼働状況をご覧いただけます。  
http://status.api.ekispert.jp/

## 特別付録！スタンダードプラン10%OFFキャンペーン

今回の出版を記念して、スタンダードプランの初期費用10%OFFできるキャンペーンコードを発行いたします。


## 脚注
[^1]: 利用上の注意 http://docs.ekispert.com/v1/get-started/attention/
[^2]: API Checker http://docs.ekispert.com/v1/tools/api-checker/
