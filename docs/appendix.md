# 付録

## 開発を始める前に {#before}
本書は駅すぱあとWebサービスの入門書として、流れを追いながら学習できるように書きました。まずは余計なことを考えずに触ってもらいたいという思いもあり、注意点等は最低限に抑えたつもりです。
ですので、改めて開発時に特に注意すべき点を付録という形で用意しておきます。
また、それ以外の注意点や詳細はオンラインで公開しているドキュメントに記載してありますのでそちらをご覧ください。

### レスポンスXMLのデータ構造について {#xml}

JSONを使われる方は流して読む程度で構いませんがXMLを使おうと考えている方は注意して読んで頂ければと思います。
駅すぱあとWebサービスでは後方互換性を保って機能追加が行われていますが、互換性維持のために幾つかのポイントを意識する必要があります。
特に重要なのが、要素の取得についてです。要素は表す内容に対してユニークですが、階層や全体のデータの中でユニークなわけではありません。
例えばStation要素は駅を表すわけですから、全体のデータ構造に対して、あらたに駅を表現する必要があれば、今までなかった階層や親要素の子要素として出現する可能性があります。ですので、現時点でのデータ構造のみを前提とした相対パスでの実装は大きな危険を伴います。同じStationでも親子関係における文脈の意味が強くでるため、必ず絶対パスで取得するようにしてください。
XMLを利用する際には、XMLパーサを利用することが多いかと思いますが、DOMでパースしてXPATHを利用する際には手軽に相対パスで取得できてしまうため、注意が必要です。

### 課金の対象を知る {#charge}

多くのAPIが用意されていますが、その中にも課金対象となるものとそうでないものがあります。意図せず無駄な課金が発生してしまい、想定していたよりも費用が掛かってしまうのは望むところではありません。
特に良くあるのが、「簡単なWebアプリケーションをつくるまでの流れと解説」の項にもある駅の入力補助をインクリメンタルサーチで実装するケースです。実装には駅情報API(/station)を用いるように見えますが、駅情報API(/station)は課金対象です。コール数が多くなるであろうインクリメンタルサーチに利用するのは現実的ではありません。そのために課金対象外のAPIとして駅簡易情報API(/station/light)を用意しています。駅簡易情報API(/station/light)は駅情報API(/station)のサブセットのような扱いになっており、駅の座標等を持っていない代わりに課金対象外となっています。インクリメンタルサーチの結果に必要なのは名称やコードなのでこのような実装には駅簡易情報API(/station/light)で十分です。
駅簡易情報API(/station/light)以外にも経路を検索するまでに必要な操作は基本的に課金対象外として用意してありますので、結果を得る過程で不要な課金を避けることができます。

いかがでしょうか？他にも注意点はありますが、全てドキュメントに記載されていますので開発を始める際にはご一読ください。

## 開発お役立ちツール {#tools}

駅すぱあとWebサービスを使って開発を行う上で、実際に著者が活用しているツールをご紹介します。

### APIの仕様理解を深める「API Checker」 {#apichecker}

「駅すぱあとWebサービス」のドキュメントサイトでは、APIを試すのにぴったりなツール「API Chercker」を用意しています。これは、APIの仕様を確認するだけではなく、APIをインタラクティブに呼び出し挙動を確認できるため、理解を深めることができます。

▼図12 ドキュメントサイトで用意しているAPI Checkerの画面

![img](/img/12.png)

### 開発者ツールを使いこなす {#devtool}

今回実装したアプリケーションのように、Javascriptを使ってWebブラウザ上で動くアプリケーションを作るなら、「開発者ツール」を使いこなしましょう。あなたの開発速度がグッとあがるはずです。
開発者ツールとは、ブラウザに搭載されているデバッグツールです。「デベロッパーツール」とも呼ばれることがありますが、本資料では「開発者ツール」と表記します。現在だとほぼ全てのWebブラウザで標準搭載されており、Windowsの場合は「F12」、Macの場合は「Option + Command + i」で起動することができます。

▼図13 Webブラウザ上で開発者ツールを立ち上げた状態（Google Chrome）

![img](/img/13.png)

ここからは、Google Chromeを例に説明します。開発者ツールの「Console」パネルは、Javascriptのデバッグに役立ちます。アプリケーションが意図しない挙動をしている時は、まずConsoleパネルでエラーが発生していないか確認しましょう。図14は、Javascriptコード内でシンタックスエラーが発生している例です。

▼図14 開発者ツールのConsoleパネル

![img](/img/14.png)

「Network」パネルは、表示しているページで行うHTTP通信が一覧として現れ、リクエスト、レスポンスの内容やアクセスの状況を見ることができます。つまり、駅すぱあとWebサービスへのアクセスに成功しているか、どんなやりとりがされているか確認することができます（図15）。

▼図15 開発者ツールのNetworkパネル

![img](/img/15.png)

細かい使い方に関してもっと知りたくなったかと思いますが、インターネット上に沢山の情報が公開されているので、ここでは割愛します。ぜひ自分で調べてみてください。
